<div class="wrapper article-content col col-lg-7 col-xl-8 col-xxl-9 px-100 ps-md-37 ps-xxl-0 pe-lg-0">
<div class="toolbar">
<nav class="breadcrumb-nav d-flex flex-wrap align-items-center min-h-rem300 fs-87 fw-400">

  
  <a href="/en/0/" class="breadcrumb-home">
    <img data-ot-ignore="" src="/en/assets/icons/breadcrumb/home-action-6.svg" class="breadcrumb-icon w-rem112 position-relative pb-1">
  </a>
  

  
    &nbsp;<img data-ot-ignore="" src="/en/assets/icons/breadcrumb/arrow-head-right-grey-6.svg" class="breadcrumb-arrow w-rem100">&nbsp;
    
    <a href="/en/1495/" class="breadcrumb-link text-nowrap">Solutions and integrations</a>
    
  

  
    &nbsp;<img data-ot-ignore="" src="/en/assets/icons/breadcrumb/arrow-head-right-grey-6.svg" class="breadcrumb-arrow w-rem100">&nbsp;
    
    <a href="/en/1499/" class="breadcrumb-link text-nowrap">Coveo for Commerce</a>
    
  

  
    &nbsp;<img data-ot-ignore="" src="/en/assets/icons/breadcrumb/arrow-head-right-grey-6.svg" class="breadcrumb-arrow w-rem100">&nbsp;
    
    <a href="/en/qbb1t000/" class="breadcrumb-link text-nowrap">Coveo Experimentation Hub</a>
    
  

  
    &nbsp;<img data-ot-ignore="" src="/en/assets/icons/breadcrumb/arrow-head-right-grey-6.svg" class="breadcrumb-arrow w-rem100">&nbsp;
    
    <a href="/en/qbb1t020/" class="breadcrumb-link text-nowrap">Data in/out</a>
    
  

  
    &nbsp;<img data-ot-ignore="" src="/en/assets/icons/breadcrumb/arrow-head-right-grey-6.svg" class="breadcrumb-arrow w-rem100">&nbsp;
    
    <a href="/en/qbb1t016/" class="breadcrumb-link text-nowrap">Our data models</a>
    
  

</nav>
</div>
<h2 class="invisible my-0 fs-0" id="bring-your-own-recommendations">Bring your own recommendations<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#bring-your-own-recommendations" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>

      <h1>Bring your own recommendations</h1>
<div class="badge-section pb-150">

  
    <div class="audience-badges-container">
      <img src="/en/assets/icons/plasma-target-miss.svg" class="audience-badges-icon me-50" data-ot-ignore="">
      <p class="me-50 mt-0 audience-badges-text">This is for: </p>
    
    
      <a href="/en/search/#f-audience=Developer" class="badge docs-badge me-100 rounded-2 fs-67 text-decoration-none">Developer</a>
    
    </div>

  

</div>
<div id="toc" class="toc">
<div id="toctitle">In this article</div>
<ul class="sectlevel1">
<li><a href="#intro">Intro</a></li>
<li><a href="#methodologies">Methodologies</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#getting-started">Getting started</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this article, we will look at how you can implement and action your own recommendation models for use in the Qubit platform.
We will also provide details of use cases showing how a model can be integrated into your personalization efforts.</p>
</div>
<div class="paragraph">
<p>In particular, we will cover:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What <code>bringing your own recommendations</code> means</p>
</li>
<li>
<p>How to bring your own model into the Qubit platform</p>
</li>
<li>
<p>Some examples of the sorts of recommendations we can provide</p>
</li>
<li>
<p>How to build your own example</p>
</li>
<li>
<p>How you can reach out to Qubit should you be interested in using your own models to power experiences</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We presume that you have already read the <a href="/en/qbb1t084/">Recommendations</a>, <a href="/en/qbb1t022/">Data Import</a>, and <a href="/en/qbb1t023/">Derived Datasets</a> overview documents to familiarize yourself with the products you will use when working with this model.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="intro">Intro<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#intro" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Product recommendations is a mechanism used to provide lists of products, appropriate for displaying in carousels, in various Placements, on a customer’s website.
Qubit provides a comprehensive recommendations product, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A variety of different recommendation strategies appropriate for different Placements</p>
</li>
<li>
<p>A detailed product catalog service that integrates with product feeds</p>
</li>
<li>
<p>A suite of marketer controls and rules</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>A focus on global vs local strategies</strong></p>
</div>
<div class="paragraph">
<p>A recommendations strategy is simply a method of generating lists of products.
There are two types, <strong>global</strong>, which means the same list of products will be shown everywhere across a website and <strong>local</strong>, which means the list of products takes a non-generic seed–a reference product or product category.
Usually, but not exclusively, the seed is a product Id and the recommendations returned are based on the seed based on some form of derived relationship.</p>
</div>
<div class="paragraph">
<p>For example, if the strategy surfaces products that are viewed together, then the seed will be a product and the returned recommendations will be products viewed alongside that seed product.
These concepts are further explained in our <a href="/en/qbb1t129#the-recommendation-seed">recommendations documentation</a>.</p>
</div>
<div class="paragraph">
<p>In addition to this core functionality, the recommendations service can also source new strategies from other parts of the product, including Data Imports (DI) and Derived Datasets (DD).
This is what is referred to as <code>Bring Your Own Recommendations</code> or BYOR, the subject of this article.</p>
</div>
<div class="paragraph">
<p>BYOR is the process of providing a list of seeds and product recommendations using either DI or DD.
Once supplied, these strategies can then be called from our <a href="/en/qbb1t129#the-recommendation-seed">Recommendations API</a> and will benefit from all the standard tooling including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enrichment with product information from the products service</p>
</li>
<li>
<p>The application of all the global marketer controls</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By allowing you to provide your own recommendations via these easy to use tools, we enable you to effortlessly productionize bespoke methods of recommendations important to your business.</p>
</div>
<div class="paragraph">
<p>For example, your internal data science team may have produced their own recommendations strategy, but might not be able to scale it to handle web traffic.
Or your merchandisers may be interested in the products that visitors go on to view after reading a particular blog article or piece of creative.</p>
</div>
<div class="paragraph">
<p>The following sections of this article aim to :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Describe how our Recommendations product works</p>
</li>
<li>
<p>Show the data format required for BYOR</p>
</li>
<li>
<p>Show how to use DI and DD to provide recommendations</p>
</li>
<li>
<p>Illustrate several example use cases</p>
</li>
<li>
<p>Describe the process for getting started with these tools</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="methodologies">Methodologies<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#methodologies" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section we describe:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How BYOR works with our Recommendations product</p>
</li>
<li>
<p>The data format in which new recommendations should be supplied</p>
</li>
<li>
<p>How you would go about setting these up using either of the DI or DD</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="recommendations-overview">Recommendations overview<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#recommendations-overview" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="paragraph">
<p>This section will present a brief overview of our recommendations service, focusing on how BYOR fits into it.</p>
</div>
<div class="paragraph">
<p>The typical way of building recommendations into an experience is to make a call to the <a href="/en/qbb1t129/">Recommendations API</a>, specifying which strategy to use and optionally a seed.
The API response is a list of products, and all the information on them required to render the experience.</p>
</div>
<div class="paragraph">
<p>Behind the scenes, after receiving a request, the Recommendations API will fetch a list of product Ids associated with the strategy from our <a href="https://redis.io/" target="_blank" rel="noopener" class="external-link">redis<img data-ot-ignore="" class="external-link-icon" src="/en/assets/icons/external/external-action-6.svg"></a> database;
which is populated by the back-end recommendation systems.
Upon retrieving this list of products Ids, the API will then enrich this list with information on each of the products using the product catalog service.
It will then fetch the list of <a href="/en/qbb1t088/">rules</a> if added, and use these to re-order or blacklist items in the list of products.
Finally, the list of product details is returned to the caller.</p>
</div>
<div class="paragraph">
<p>This is illustrated in the following diagram, which also shows the data sources and processes that power Recommendations (Recs) on the left and Bring Your Own Recommendations (BYOR) on the right</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/en/assets/images/coveo-for-commerce/images/bqml/byo/image_0.png" alt="overview" data-ot-ignore="">
</div>
</div>
<div class="paragraph">
<p>If a strategy is provided to the Recommendations API that doesn’t exist in redis, then the API will try to get it from our Stash database instead.
In this way, any system that can populate data in Stash in the correct format, can also power recommendations and benefit from all its functionality.</p>
</div>
<div class="paragraph">
<p>We have two primary ways of populating data into Stash:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="/en/qbb1t022/">Data Imports</a> (DI) - Using a user-provided CSV file or a CSV stored in a Google Cloud Storage (GCS) bucket</p>
</li>
<li>
<p><a href="/en/qbb1t023/">Derived Datasets</a> (DD) - Runs queries on top of BigQuery</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<img src="/en/assets/icons/warning.svg" alt="Warning" data-ot-ignore="">
</td>
<td class="content">
<div class="paragraph">
<p>Any new strategy must have a unique name and must not match the name of any existing recommendations strategy.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The following table identifies our current recommendations strategies:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Strategy name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pllr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses log likelihood ratio to surface product connections based on views</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pllr_bought</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses log likelihood ratio to surface product connections based on purchases</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pllr_viewed_bought</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses log likelihood ratio to surface product connections based on a combination of views and purchases</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pllr_bought_next</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses log likelihood ratio to recommend products bought next</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trending_popular_views_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Most viewed/bought products across a site over the last 30 days</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trending_ols_views_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trending products</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trending_ewma_views_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Products that are popular by views with a greater emphasis on more recent views</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_viewed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses collaborative filtering to recommend products based on product views</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_bought</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses collaborative filtering to recommend products based on product purchases</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">new_arrivals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Recommends products recently added to a product catalog</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="data-format">Data format<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#data-format" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="paragraph">
<p>Data in Stash should be provided in two columns, the first column <code>seed</code> should be a string.
This is what will be provided by the caller to the Recommendations API and is used to determine which recommendations should be shown.
This key can be any string and does not have to match anything in the product catalog.
For example, you can seed recommendations from page URLs or even product categories.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<img src="/en/assets/icons/note.svg" alt="" data-ot-ignore="">
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>In the recommendations product, the seed typically corresponds to either product Ids or categories for local strategies, such as viewed together or brought together, or a simple catch-all <code>all</code> seed for global ones.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The second column <code>recs</code> should be a single string consisting of comma-separated product Ids and weights, i.e.
numbers representing the quality of the recommendation.
A higher weight is better, and recommended items are ranked from highest weight to lowest.
These product Ids should match products found in your product catalog.
An example is given below, which highlights the data format needed to power BYOR:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">seed</th>
<th class="tableblock halign-left valign-top">recs</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">P1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"`P2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.99</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.98`"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"`P1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.94</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">P3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.91`"</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<img src="/en/assets/icons/warning.svg" alt="Warning" data-ot-ignore="">
</td>
<td class="content">
<div class="paragraph">
<p>The column titles are case sensitive and should be provided in lower case.
Examples of how to prepare data in this format within a CSV or a SQL query are given in the following sections.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="data-imports">Data imports<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#data-imports" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="paragraph">
<p>Our Data Imports (DI) product is described comprehensively in <a href="/en/qbb1t022/">Importing Your Data</a>.</p>
</div>
<div class="paragraph">
<p>In this section, we will walk through how to use this system to provide your own recommendations.
To begin with, you will need two things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Recommendations product and running correctly - See in particular <a href="/en/qbb1t085/">Building the Catalog</a></p>
</li>
<li>
<p>A CSV file containing your recommendations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example CSV file would be:</p>
</div>
<div class="listingblock">
<div class="content position-relative">
<pre class="rouge highlight" id="code-snippet-1"><code data-lang="CSV">seed,recs
"1","2,0.98,3,0.5"
"2","1,0.6,3,0.4"
"3","1,0.5,2,0.4"
"other","3,0.9,2,0.8,1,0.7"</code></pre>
<button type="button" class="btn copy-to-clipboard-btn position-absolute top-rem062 end-rem062" data-bs-toggle="tooltip" data-bs-custom-class="tooltip-copy-to-clipboard" data-bs-placement="left" title="" data-clipboard-target="#code-snippet-1" data-bs-original-title="Click to copy code to clipboard." aria-label="Click to copy code to clipboard."><img class="copy-to-clipboard-icon" src="/en/assets/icons/duplicate.svg"></button></div>
</div>
<div class="paragraph">
<p>This can then be <a href="/en/qbb1t022#creating-a-new-import">imported</a> following the normal DI method.</p>
</div>
<div class="sect3">
<h4 id="step-1">Step 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#step-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
<div class="paragraph">
<p>Select <strong>Data tools</strong> &gt; <strong>Import</strong> from the side menu</p>
</div>
<div class="paragraph">
<p>Select <strong>New import</strong> and then <strong>Ingested data</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="/en/assets/images/coveo-for-commerce/images/bqml/byo/image_1.png" alt="ingested-data" data-ot-ignore="">
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-2">Step 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#step-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
<div class="paragraph">
<p>Select a custom schema and enter <strong>seed</strong> as the first attribute name and the primary key.
Enter <strong>recs</strong> as the name of second attribute.
Both should be of type string and their names should be lower case</p>
</div>
<div class="paragraph">
<p>Set them to be available for look up and save</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/en/assets/images/coveo-for-commerce/images/bqml/byo/image_2.png" alt="lookup" data-ot-ignore="">
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-3">Step 3<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#step-3" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
<div class="paragraph">
<p>Select <strong>Import data</strong> and then either <strong>Manual Upload</strong> or <strong>Programmatic Batch</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you are using manual upload, select <strong>Add your CSV</strong> and select the CSV from your local machine or other location</p>
</li>
<li>
<p>If you are using programmatic batch, transfer your CSV to the location shown in Import new data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wait for the validation to complete and then save</p>
</div>
<div class="paragraph">
<p>Once your import is complete you can request it via the Recommendations API.</p>
</div>
<div class="paragraph">
<p>An example using the curl command, for the example illustrated above, for a demo property with a tracking Id kn8, and a DI called demobyor_ would be:</p>
</div>
<div class="listingblock">
<div class="content position-relative">
<pre class="rouge highlight" id="code-snippet-2"><code data-lang="JavaScript">curl -X POST 'https://recs.qubit.com/vc/recommend/2.1/kn8?strategy=demo_byor&amp;n=1' -H 'content-type: application/json' -d '{"h": ["1"]}'</code></pre>
<button type="button" class="btn copy-to-clipboard-btn position-absolute top-rem062 end-rem062" data-bs-toggle="tooltip" data-bs-custom-class="tooltip-copy-to-clipboard" data-bs-placement="left" title="" data-clipboard-target="#code-snippet-2" data-bs-original-title="Click to copy code to clipboard." aria-label="Click to copy code to clipboard."><img class="copy-to-clipboard-icon" src="/en/assets/icons/duplicate.svg"></button></div>
</div>
<div class="paragraph">
<p>This returns:</p>
</div>
<div class="listingblock">
<div class="content position-relative">
<pre class="rouge highlight" id="code-snippet-3"><code data-lang="js"><span class="p">{</span>
  <span class="dl">"</span><span class="s2">items</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">2</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">weight</span><span class="dl">"</span><span class="p">:</span> <span class="mf">0.98</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">strategy</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">demo_byor</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">details</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1">// ...</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre>
<button type="button" class="btn copy-to-clipboard-btn position-absolute top-rem062 end-rem062" data-bs-toggle="tooltip" data-bs-custom-class="tooltip-copy-to-clipboard" data-bs-placement="left" title="" data-clipboard-target="#code-snippet-3" data-bs-original-title="Click to copy code to clipboard." aria-label="Click to copy code to clipboard."><img class="copy-to-clipboard-icon" src="/en/assets/icons/duplicate.svg"></button></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="derived-datasets">Derived datasets<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#derived-datasets" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="paragraph">
<p>The DD product is described comprehensively in <a href="/en/qbb1t023/">Building A Derived Dataset</a>.
In this section, we will walk through how to use this tool to provide your own recommendations.
To begin with, you will need two things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Recommendations product and running correctly - See in particular <a href="/en/qbb1t085/">Building the Catalog</a></p>
</li>
<li>
<p>A SQL query to generate your recommendations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example SQL query file could be:</p>
</div>
<div class="listingblock">
<div class="content position-relative">
<pre class="rouge highlight" id="code-snippet-4"><code data-lang="SQL">WITH
device_product_views AS (
SELECT
s.deviceType,
product_productId,
COUNT(*) AS num_product_views
FROM
`qubit-client-36902.kn8__v2.event_ecProduct` AS p
INNER JOIN
`qubit-client-36902.kn8__v2.event_qubit_session` AS s
ON
p.context_id = s.context_id
AND p.context_sessionNumber = s.context_sessionNumber
WHERE
EXTRACT(DATE FROM p.meta_serverTs) BETWEEN
DATE_ADD(CURRENT_DATE(), INTERVAL -7 DAY)
AND CURRENT_DATE()
AND eventType = 'detail'
AND product_productId IS NOT NULL
AND product_productId != ''
GROUP BY
1,
2
)

SELECT
deviceType AS seed,
STRING_AGG(
CONCAT(product_productId, ',', CAST(num_product_views AS STRING)) ORDER BY num_product_views DESC
LIMIT 10
) AS recs
FROM
device_product_views
GROUP BY
1</code></pre>
<button type="button" class="btn copy-to-clipboard-btn position-absolute top-rem062 end-rem062" data-bs-toggle="tooltip" data-bs-custom-class="tooltip-copy-to-clipboard" data-bs-placement="left" title="" data-clipboard-target="#code-snippet-4" data-bs-original-title="Click to copy code to clipboard." aria-label="Click to copy code to clipboard."><img class="copy-to-clipboard-icon" src="/en/assets/icons/duplicate.svg"></button></div>
</div>
<div class="paragraph">
<p>This example recommends the ten most viewed product Ids for each device type and can then be set up to run on a schedule following the normal DD methodologies.
To use this on your own data, simply change the BigQuery project and dataset to your own.</p>
</div>
<div class="sect3">
<h4 id="step-1-2">Step 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#step-1-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
<div class="paragraph">
<p>Select <strong>Data tools</strong> &gt; <strong>Import</strong> from the side menu</p>
</div>
<div class="paragraph">
<p>Select <strong>New import</strong> and then <strong>Derived data</strong></p>
</div>
</div>
<div class="sect3">
<h4 id="step-2-2">Step 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#step-2-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
<div class="paragraph">
<p>Select the empty template from the template gallery and then select <strong>Choose</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="/en/assets/images/coveo-for-commerce/images/bqml/byo/image_4.png" alt="template" data-ot-ignore="">
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-3-2">Step 3<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#step-3-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
<div class="paragraph">
<p>Paste your SQL query into the editor</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/en/assets/images/coveo-for-commerce/images/bqml/byo/image_5.png" alt="SQL query" data-ot-ignore="">
</div>
</div>
<div class="paragraph">
<p>Select <strong>Run query</strong> to check it works.</p>
</div>
<div class="paragraph">
<p>Now confirm the setup, ensure the fields are available for lookup and select <strong>Save</strong>.
Your query will now run</p>
</div>
<div class="paragraph">
<p>Once your complete you can request it via the Recommendations API.</p>
</div>
<div class="paragraph">
<p>An example using the curl command, for the example illustrated above, for a demo property with a tracking ID <code>kn8</code> and a DD called <code>demodd_byor</code> would be:</p>
</div>
<div class="listingblock">
<div class="content position-relative">
<pre class="rouge highlight" id="code-snippet-5"><code data-lang="JavaScript">curl -X POST 'https://recs.qubit.com/vc/recommend/2.1/kn8?strategy=demo_dd_byor&amp;n=1' -H 'content-type: application/json' -d '{"h": ["1"]}'</code></pre>
<button type="button" class="btn copy-to-clipboard-btn position-absolute top-rem062 end-rem062" data-bs-toggle="tooltip" data-bs-custom-class="tooltip-copy-to-clipboard" data-bs-placement="left" title="" data-clipboard-target="#code-snippet-5" data-bs-original-title="Click to copy code to clipboard." aria-label="Click to copy code to clipboard."><img class="copy-to-clipboard-icon" src="/en/assets/icons/duplicate.svg"></button></div>
</div>
<div class="paragraph">
<p>This returns:</p>
</div>
<div class="listingblock">
<div class="content position-relative">
<pre class="rouge highlight" id="code-snippet-6"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span><span class="p">,</span><span class="w">
      </span><span class="nl">"strategy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"demo_dd_byor"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">//</span><span class="w"> </span><span class="err">...</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre>
<button type="button" class="btn copy-to-clipboard-btn position-absolute top-rem062 end-rem062" data-bs-toggle="tooltip" data-bs-custom-class="tooltip-copy-to-clipboard" data-bs-placement="left" title="" data-clipboard-target="#code-snippet-6" data-bs-original-title="Click to copy code to clipboard." aria-label="Click to copy code to clipboard."><img class="copy-to-clipboard-icon" src="/en/assets/icons/duplicate.svg"></button></div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples">Examples<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#examples" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, we will walk through several examples of how BYOR can be applied.</p>
</div>
<div class="sect2">
<h3 id="viewed-together">Viewed together<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#viewed-together" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="paragraph">
<p>The SQL shown below creates recommendations between viewed products and those that are viewed next.
It draws connections between products' <a href="/en/qbb1t331#whats-the-difference-between-collaborative-filtering-and-log-likelihood-ratio">Log Likelihood Ratio</a> (LLR), which is a statistical technique for finding how closely related pairs of items are.
LLR is a common method for producing product recommendations and is used by our own recommendation engine.</p>
</div>
<div class="paragraph">
<p>In this case, the seed is a product Id:</p>
</div>
<div class="listingblock">
<div class="content position-relative">
<pre class="rouge highlight" id="code-snippet-7"><code data-lang="SQL">WITH

    transitions AS (

SELECT

    sourceProductId,

    destProductId,

    COUNT(*) AS transitionCount

FROM (

    SELECT

        product_productId AS sourceProductId,

        LEAD(product_productId) OVER (

            PARTITION BY context_id, context_sessionNumber

            ORDER BY context_sessionViewNumber

        ) AS destProductId

    FROM

        `qubit-client-36902.kn8__v2.event_ecProduct`

    WHERE

        EXTRACT(DATE FROM meta_serverTs) BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) AND CURRENT_DATE()

        AND product_productId IS NOT NULL

        AND eventType = "detail"

)

WHERE

    destProductId IS NOT NULL

    AND sourceProductId != destProductId

GROUP BY

  1, 2

),

    counts AS (

SELECT

    sourceProductId,

    destProductId,

    IF(

        transitionCount &gt; 0,

        transitionCount,

        0.01

    ) AS k11,

    -- k12 should be all instances of dest without source

    IF(

        (destCount - transitionCount) &gt; 0,

        destCount - transitionCount,

        0.01

    ) AS k12,

    -- k21 should be all instances of source without dest

    IF(

        (sourceCount - transitionCount) &gt; 0,

        sourceCount - transitionCount,

        0.01

    ) AS k21,

    --k22 should be instances without either

    IF(

        (allCount - sourceCount - destCount + transitionCount) &gt; 0,

        allCount - sourceCount - destCount + transitionCount,

        0.01

    ) AS k22,

    sourceCount,

    destCount,

    allCount

FROM (

    SELECT

        *,

        SUM(transitionCount) OVER (PARTITION BY sourceProductId) AS sourceCount,

        SUM(transitionCount) OVER (PARTITION BY destProductId) AS destCount,

        SUM(transitionCount) OVER () AS allCount

    FROM

        transitions

)



),

    entropy AS (

SELECT

    *,

    2 * (IF(rowEntropy + colEntropy &lt; matrixEntropy,

            0.,

            rowEntropy + colEntropy - matrixEntropy)

    ) AS llr

FROM (

    SELECT

        *,

        ((k11+k12+k21+k22) * LOG(k11+k12+k21+k22))

            - ((k11+k12)*LOG(k11+k12))

            - ((k21+k22)*LOG(k21+k22))

        AS rowEntropy,

        ((k11+k12+k21+k22) * LOG(k11+k12+k21+k22))

            - ((k11+k21)*LOG(k11+k21))

            - ((k12+k22)*LOG(k12+k22))

        AS colEntropy,

        ((k11+k12+k21+k22) * LOG(k11+k12+k21+k22))

            - (k11*LOG(k11)) - (k12*LOG(k12))

            - (k21*LOG(k21)) - (k22*LOG(k22))

        AS matrixEntropy

    FROM

        counts

)

),

    recommendations AS (

-- Recommendations --

-- calculate the logLikelihoodRatio between two products (this is a distance measure)

-- convert to a similarity measure

-- filter, so each product only has a fixed number of product results

SELECT

    sourceProductId,

    destProductId,

    IFNULL(CAST(llrSimilarity * 10000 AS INT64) / 10000, 0) AS llrSimilarity

FROM (

    SELECT

      *,

      ROW_NUMBER() OVER (PARTITION BY sourceProductId ORDER BY llrSimilarity DESC) AS rowNum

    FROM (

      SELECT

        sourceProductId,

        destProductId,

        (1 - (1 / (1 + llr))) AS llrSimilarity

      FROM

          entropy



    )

)

WHERE

    llrSimilarity &gt; 0.00015708785790970604  -- scipy.stats.chi2.isf(0.99, 1)

    AND rowNum &lt;= 100

ORDER BY

    sourceProductId, llrSimilarity DESC

),

    aggregates AS (

SELECT

    sourceProductId AS seed,

    STRING_AGG(

        CONCAT(destProductId, ',', CAST(llrSimilarity AS STRING))

        ORDER BY llrSimilarity DESC

    ) AS recs

FROM

    recommendations

GROUP BY

    sourceProductId

)

SELECT

    *

FROM

    aggregates</code></pre>
<button type="button" class="btn copy-to-clipboard-btn position-absolute top-rem062 end-rem062" data-bs-toggle="tooltip" data-bs-custom-class="tooltip-copy-to-clipboard" data-bs-placement="left" title="" data-clipboard-target="#code-snippet-7" data-bs-original-title="Click to copy code to clipboard." aria-label="Click to copy code to clipboard."><img class="copy-to-clipboard-icon" src="/en/assets/icons/duplicate.svg"></button></div>
</div>
</div>
<div class="sect2">
<h3 id="bought-after-viewing-a-page">Bought after viewing a page<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#bought-after-viewing-a-page" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="paragraph">
<p>The SQL shown below creates recommendations between viewed pages and what visitors went on to purchase next.
Again this strategy uses the LLR statistic to draw connections between products.</p>
</div>
<div class="paragraph">
<p>In this case, the seed is a page URL:</p>
</div>
<div class="listingblock">
<div class="content position-relative">
<pre class="rouge highlight" id="code-snippet-8"><code data-lang="SQL">-- A LLR recommendation that uses meta_url as the source

-- and the next ecBasketItemTransaction as the destination

WITH sources AS (

SELECT

  SPLIT(meta_url, "?")[SAFE_ORDINAL(1)] AS sourceId,

  CAST(NULL AS STRING) AS destId,

  context_id,

  context_sessionNumber,

  context_sessionViewNumber

FROM

  `qubit-client-36902.kn8__v2.event_ecView`

WHERE

  EXTRACT(DATE FROM meta_serverTs) BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) AND CURRENT_DATE()

  AND type = "category"

GROUP BY

  1, 2, 3, 4, 5

),

destinations AS (

SELECT

  CAST(NULL AS STRING) AS sourceId,

  product_productId AS destId,

  context_id,

  context_sessionNumber,

  context_sessionViewNumber

FROM

  `qubit-client-36902.kn8__v2.event_ecBasketItemTransaction`

WHERE

  EXTRACT(DATE FROM meta_serverTs) BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) AND CURRENT_DATE()

  AND product_productId IS NOT NULL

GROUP BY

  1, 2, 3, 4, 5

), combined AS (

  SELECT

    *,

    LAST_VALUE(sourceId IGNORE NULLS) OVER (

      PARTITION BY context_id, context_sessionNumber

      ORDER BY context_sessionViewNumber

      ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING

    ) AS lag_source

  FROM (

    SELECT * FROM sources

    UNION ALL

    SELECT * FROM destinations

  )

)

,

transitions AS (

SELECT

    sourceId,

    destId,

    COUNT(*) AS transitionCount

FROM (

    SELECT

        lag_source AS sourceId,

        destId

    FROM

        combined

    WHERE

        lag_source IS NOT NULL

        AND destId IS NOT NULL

        AND lag_source != destId

)

GROUP BY

  1, 2

),

    counts AS (

SELECT

    sourceId,

    destId,

    IF(

        transitionCount &gt; 0,

        transitionCount,

        0.01

    ) AS k11,

    -- k12 should be all instances of dest without source

    IF(

        (destCount - transitionCount) &gt; 0,

        destCount - transitionCount,

        0.01

    ) AS k12,

    -- k21 should be all instances of source without dest

    IF(

        (sourceCount - transitionCount) &gt; 0,

        sourceCount - transitionCount,

        0.01

    ) AS k21,

    --k22 should be instances without either

    IF(

        (allCount - sourceCount - destCount + transitionCount) &gt; 0,

        allCount - sourceCount - destCount + transitionCount,

        0.01

    ) AS k22,

    sourceCount,

    destCount,

    allCount

FROM (

    SELECT

        *,

        SUM(transitionCount) OVER (PARTITION BY sourceId) AS sourceCount,

        SUM(transitionCount) OVER (PARTITION BY destId) AS destCount,

        SUM(transitionCount) OVER () AS allCount

    FROM

        transitions

)



),

    entropy AS (

SELECT

    *,

    2 * (IF(rowEntropy + colEntropy &lt; matrixEntropy,

            0.,

            rowEntropy + colEntropy - matrixEntropy)

    ) AS llr

FROM (

    SELECT

        *,

        ((k11+k12+k21+k22) * LOG(k11+k12+k21+k22))

            - ((k11+k12)*LOG(k11+k12))

            - ((k21+k22)*LOG(k21+k22))

        AS rowEntropy,

        ((k11+k12+k21+k22) * LOG(k11+k12+k21+k22))

            - ((k11+k21)*LOG(k11+k21))

            - ((k12+k22)*LOG(k12+k22))

        AS colEntropy,

        ((k11+k12+k21+k22) * LOG(k11+k12+k21+k22))

            - (k11*LOG(k11)) - (k12*LOG(k12))

            - (k21*LOG(k21)) - (k22*LOG(k22))

        AS matrixEntropy

    FROM

        counts

)

),

    recommendations AS (

-- Recommendations --

-- calculate the logLikelihoodRatio between two products (this is a distance measure)

-- convert to a similarity measure

-- filter, so each product only has a fixed number of product results

SELECT

    sourceId,

    destId,

    IFNULL(CAST(llrSimilarity * 10000 AS INT64) / 10000, 0) AS llrSimilarity

FROM (

    SELECT

      *,

      ROW_NUMBER() OVER (PARTITION BY sourceId ORDER BY llrSimilarity DESC) AS rowNum

    FROM (

      SELECT

        sourceId,

        destId,

        (1 - (1 / (1 + llr))) AS llrSimilarity

      FROM

          entropy



    )

)

WHERE

    llrSimilarity &gt; 0.00015708785790970604  -- scipy.stats.chi2.isf(0.99, 1)

    AND rowNum &lt;= 100

ORDER BY

    sourceId, llrSimilarity DESC

),

    aggregates AS (

SELECT

    sourceId AS seed,

    STRING_AGG(

        CONCAT(destId, ',', CAST(llrSimilarity AS STRING))

        ORDER BY llrSimilarity DESC

    ) AS recs

FROM

    recommendations

GROUP BY

    sourceId

)

SELECT

    *

FROM

    aggregates</code></pre>
<button type="button" class="btn copy-to-clipboard-btn position-absolute top-rem062 end-rem062" data-bs-toggle="tooltip" data-bs-custom-class="tooltip-copy-to-clipboard" data-bs-placement="left" title="" data-clipboard-target="#code-snippet-8" data-bs-original-title="Click to copy code to clipboard." aria-label="Click to copy code to clipboard."><img class="copy-to-clipboard-icon" src="/en/assets/icons/duplicate.svg"></button></div>
</div>
</div>
<div class="sect2">
<h3 id="new-arrivals">New arrivals<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#new-arrivals" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="paragraph">
<p>The SQL shown below creates a global recommendation based on when products first appeared on the site.
This recommendation is already available as a template within Derived Datasets called <code>New Arrivals</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<img src="/en/assets/icons/note.svg" alt="" data-ot-ignore="">
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This is a global strategy.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content position-relative">
<pre class="rouge highlight" id="code-snippet-9"><code data-lang="SQL">WITH

  LAST30DAYS AS (

  SELECT

    SAFE_CAST(meta_recordDate AS DATE) AS meta_recordDate,

    product_productId AS product_id,

    COUNT(*) AS product_detail_views

  FROM

    `qubit-client-36902.kn8__v2.event_ecProduct`

  WHERE

    meta_serverTs &gt; TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)

    AND product_productId IS NOT NULL

    AND product_productId != ''

    AND eventType = 'detail'

  GROUP BY

    1,

    2 ),

  Input AS (

  SELECT

    product_id,

    MIN(meta_recordDate) AS first_date_seen,

    SUM(product_detail_views) AS product_detail_views,

    AVG(product_detail_views)/(DATE_DIFF(CURRENT_DATE(), MIN(meta_recordDate), DAY) + 1) AS weighted_avg_daily_product_detail_views

  FROM

    LAST30DAYS

  GROUP BY

    1 ),

  TOP100RECS AS (

  SELECT

    'all' AS seed,

    product_id AS rec,

    weighted_avg_daily_product_detail_views AS weight

  FROM

    Input

  WHERE

    first_date_seen &gt;= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) -- first seen in the last 7 days

    AND product_detail_views &gt; 10 -- number of product views greater than 10, to remove rarely seen products

  ORDER BY

    weight DESC

  LIMIT

    100 )

SELECT

  MIN(seed) AS seed,

  STRING_AGG(CONCAT(rec, ',', CAST(weight AS STRING))

  ORDER BY

    weight DESC) AS recs

FROM

  TOP100RECS</code></pre>
<button type="button" class="btn copy-to-clipboard-btn position-absolute top-rem062 end-rem062" data-bs-toggle="tooltip" data-bs-custom-class="tooltip-copy-to-clipboard" data-bs-placement="left" title="" data-clipboard-target="#code-snippet-9" data-bs-original-title="Click to copy code to clipboard." aria-label="Click to copy code to clipboard."><img class="copy-to-clipboard-icon" src="/en/assets/icons/duplicate.svg"></button></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started">Getting started<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#getting-started" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you wish to import your own recommendations model for use in Qubit experiences, contact your Customer Success Manager and ask for the early access signup form.
Submit this form, specifying <strong>BYOR</strong> as the project you are interested in.</p>
</div>
</div>
</div>
<div class="container feedback-section p-150 mt-400 rounded-4"><div class="row gx-0"><div class="feedback-title col-12 pb-100 fs-112 fw-400">Was this article useful?</div><div class="col feedback-below-article-buttons"><a class="btn btn-outline-primary feedback-btn thumbs-up-btn me-200" role="button" data-bs-toggle="modal" data-bs-target="#positive-feedback-modal"><img data-ot-ignore="" src="/en/assets/icons/feedback/thumbs-up-action-8.svg" class="feedback-icon thumbs-up-icon w-rem100 me-50">Very useful</a><a class="btn btn-outline-primary feedback-btn thumbs-down-btn" role="button" data-bs-toggle="modal" data-bs-target="#negative-feedback-modal"><img data-ot-ignore="" src="/en/assets/icons/feedback/thumbs-down-action-8.svg" class="feedback-icon thumbs-down-icon w-rem100 me-50">Not really</a></div><div class="feedback-toast-container p-75"><div class="toast" id="feedback-toast" role="alert" aria-live="assertive" aria-atomic="true"><div class="toast-header"><img class="rounded me-50" src="/en/assets/favicon.ico" alt="..."><div class="me-auto fw-400">Thanks for your feedback!</div><button class="btn-close feedback-toast-close me-0" type="button" data-bs-dismiss="toast" aria-label="Close"></button></div></div></div><iframe class="d-none" name="frame"></iframe></div></div><div class="modal feedback-modal fade" id="positive-feedback-modal" style="display: none;" data-bs-backdrop="static" tabindex="-1" aria-labelledby="feedback-modal-title" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content feedback-modal-content">
      <div class="modal-header row px-0 mx-0">
        <div class="modal-title col-12 px-200 fs-150 fw-400">
          Is this article useful?
        </div>
        <div class="modal-subtitle col-12 px-200 pb-150 fs-75 fw-100">
          You can close this window or leave a comment below.
        </div>
        <div class="modal-title-buttons col px-200">
          <a class="btn feedback-modal-btn modal-thumbs-up-btn px-100 py-25 me-200 active pe-none" role="button" data-bs-toggle="modal" data-bs-target="#positive-feedback-modal">
            <img src="/en/assets/icons/feedback/thumbs-up-action-8.svg" class="feedback-modal-icon modal-thumbs-up-icon w-rem100 active-icon" data-ot-ignore="">
            Very useful
          </a>
          <a class="btn feedback-modal-btn modal-thumbs-down-btn px-100 py-25 " role="button" data-bs-toggle="modal" data-bs-target="#negative-feedback-modal">
            <img src="/en/assets/icons/feedback/thumbs-down-action-8.svg" class="feedback-modal-icon modal-thumbs-down-icon w-rem100 " data-ot-ignore="">
            Not really
          </a>
        </div>
        <button type="button" class="btn-close feedback-modal-close-btn position-absolute end-rem200" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body feedback-modal-body px-0">
        <form target="frame">
          <div id="feedback-intro" class="form-text feedback-form-text px-200 pb-50">
            Can you tell us more about your experience today?
          </div>
          <div class="form-floating feedback-floating-textarea px-200 mb-100">
            <textarea id="feedback-textarea" name="positive-feedback-text" class="form-control h-rem800 rounded-4 font-monospace fs-87" placeholder="Leave a comment here."></textarea>
            <label for="feedback-textarea" class="ps-300">Comments (optional)</label>
          </div>
          <div id="feedback-email-intro" class="form-text feedback-form-text px-200 pb-50">
            Leave your email address if you'd like us to get back to you.
          </div>
          <div class="form-floating px-200 mb-100">
            <input type="email" id="feedback-email" name="positive-feedback-email" class="form-control rounded-4 font-monospace fs-87" placeholder="name@example.com">
            <label for="feedback-email" class="ps-300">Email (optional)</label>
            <div class="invalid-feedback">
              Please provide a valid email address.
            </div>
            <div id="feedback-privacy-policy" class="form-text feedback-form-text pt-25 fs-62">
              The Coveo <a href="https://www.coveo.com/en/pages/privacy-policy?utm_marketing_tactic=docs" target="_blank" class="external-link">Privacy Policy<img data-ot-ignore="" class="external-link-icon" src="/en/assets/icons/external/external-action-6.svg"></a> applies.
            </div>
          </div>
          <div class="modal-footer row px-200 g-0">
            <div id="feedback-ask-community" class="form-text feedback-form-text col">
              Need help? <a href="https://connect.coveo.com/s/discussions" target="_blank" class="external-link">Ask the Community<img data-ot-ignore="" class="external-link-icon" src="/en/assets/icons/external/external-action-6.svg"></a>.
            </div>
            <div class="feedback-submission-button text-end col">
              <button type="submit" class="btn btn-primary feedback-submit-btn">Submit</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<div class="modal feedback-modal fade" id="negative-feedback-modal" style="display: none;" data-bs-backdrop="static" tabindex="-1" aria-labelledby="feedback-modal-title" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content feedback-modal-content">
      <div class="modal-header row px-0 mx-0">
        <div class="modal-title col-12 px-200 fs-150 fw-400">
          Is this article useful?
        </div>
        <div class="modal-subtitle col-12 px-200 pb-150 fs-75 fw-100">
          You can close this window or leave a comment below.
        </div>
        <div class="modal-title-buttons col px-200">
          <a class="btn feedback-modal-btn modal-thumbs-up-btn px-100 py-25 me-200 " role="button" data-bs-toggle="modal" data-bs-target="#positive-feedback-modal">
            <img src="/en/assets/icons/feedback/thumbs-up-action-8.svg" class="feedback-modal-icon modal-thumbs-up-icon w-rem100 " data-ot-ignore="">
            Very useful
          </a>
          <a class="btn feedback-modal-btn modal-thumbs-down-btn px-100 py-25 active pe-none" role="button" data-bs-toggle="modal" data-bs-target="#negative-feedback-modal">
            <img src="/en/assets/icons/feedback/thumbs-down-action-8.svg" class="feedback-modal-icon modal-thumbs-down-icon w-rem100 active-icon" data-ot-ignore="">
            Not really
          </a>
        </div>
        <button type="button" class="btn-close feedback-modal-close-btn position-absolute end-rem200" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body feedback-modal-body px-0">
        <form target="frame">
          <div id="feedback-intro" class="form-text feedback-form-text px-200 pb-50">
            Can you tell us more about your experience today?
          </div>
          <div class="form-floating feedback-floating-textarea px-200 mb-100">
            <textarea id="feedback-textarea" name="negative-feedback-text" class="form-control h-rem800 rounded-4 font-monospace fs-87" placeholder="Leave a comment here."></textarea>
            <label for="feedback-textarea" class="ps-300">Comments (optional)</label>
          </div>
          <div id="feedback-email-intro" class="form-text feedback-form-text px-200 pb-50">
            Leave your email address if you'd like us to get back to you.
          </div>
          <div class="form-floating px-200 mb-100">
            <input type="email" id="feedback-email" name="negative-feedback-email" class="form-control rounded-4 font-monospace fs-87" placeholder="name@example.com">
            <label for="feedback-email" class="ps-300">Email (optional)</label>
            <div class="invalid-feedback">
              Please provide a valid email address.
            </div>
            <div id="feedback-privacy-policy" class="form-text feedback-form-text pt-25 fs-62">
              The Coveo <a href="https://www.coveo.com/en/pages/privacy-policy?utm_marketing_tactic=docs" target="_blank" class="external-link">Privacy Policy<img data-ot-ignore="" class="external-link-icon" src="/en/assets/icons/external/external-action-6.svg"></a> applies.
            </div>
          </div>
          <div class="modal-footer row px-200 g-0">
            <div id="feedback-ask-community" class="form-text feedback-form-text col">
              Need help? <a href="https://connect.coveo.com/s/discussions" target="_blank" class="external-link">Ask the Community<img data-ot-ignore="" class="external-link-icon" src="/en/assets/icons/external/external-action-6.svg"></a>.
            </div>
            <div class="feedback-submission-button text-end col">
              <button type="submit" class="btn btn-primary feedback-submit-btn">Submit</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<div class="container recommendation-section pb-100">
  <atomic-recs-interface id="docs-recommendation" search-hub="peopleAlsoViewedOnDocs" analytics="" language="en" language-assets-path="./lang" icon-assets-path="./assets" class="hydrated">
    <atomic-recs-list label="What's next for me?" recommendation="Recommendation" number-of-recommendations="3" data-atomic-rendered="false" data-atomic-loaded="false" class="atomic-hidden hydrated" display="list" density="normal" image-size="small" heading-level="0">
      <atomic-recs-result-template class="hydrated">
        <template>
          <style>
            atomic-result-section-excerpt{
              max-height: 3rem !important;
              margin: 0px !important;
              font-size: 0.75rem !important;
            }
            atomic-result-link atomic-result-text {
              font-size: 1rem !important;
              font-weight: 400;
              color: var(--atomic-recommendations-text);
            }
          </style>

          <atomic-result-section-title>
            <atomic-result-link></atomic-result-link>
          </atomic-result-section-title>
          <atomic-result-section-excerpt class="field" if-defined="excerpt">
            <atomic-result-text field="excerpt"></atomic-result-text>
          </atomic-result-section-excerpt>
        </template>
      </atomic-recs-result-template>
    </atomic-recs-list>
  </atomic-recs-interface>
</div>
</div>
